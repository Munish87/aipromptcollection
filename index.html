<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Prompt Collections</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">

  <header class="bg-white shadow p-4 text-center">
    <h1 class="text-2xl font-bold">AI Prompt Collections</h1>
    <p class="text-gray-500">Curated JSON list of best prompts for ChatGPT, MidJourney, etc.</p>
  </header>

  <main class="max-w-5xl mx-auto p-6">
    <div class="flex flex-col md:flex-row items-center gap-4 mb-6">
      <select id="categoryFilter" class="border p-2 rounded-lg shadow-sm">
        <option value="all">All Categories</option>
      </select>
      <input id="searchInput" type="text" placeholder="Search prompts..." class="flex-grow border p-2 rounded-lg shadow-sm">
      <button onclick="showRandomPrompt()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg shadow">Random Prompt</button>
    </div>

    <div id="promptContainer" class="grid md:grid-cols-2 gap-4"></div>
  </main>

  <script>
    let allPrompts = [];
    let filteredPrompts = [];

    async function loadPrompts() {
      try {
        const res = await fetch("https://raw.githubusercontent.com/Munish87/aipromptcollection/main/prompts.json");
        const data = await res.json();
        console.log("Loaded prompts from GitHub:", data);
        allPrompts = data;
        filteredPrompts = [...allPrompts];
        populateCategories();
        renderPrompts(filteredPrompts);
      } catch (err) {
        console.error("Error loading prompts:", err);
        document.getElementById("promptContainer").innerHTML =
          "<p class='text-red-500'>⚠️ Failed to load prompts.</p>";
      }
    }

    function populateCategories() {
      const categorySet = new Set(allPrompts.map(p => p.category));
      const categoryFilter = document.getElementById("categoryFilter");
      categorySet.forEach(cat => {
        const option = document.createElement("option");
        option.value = cat.toLowerCase();
        option.textContent = cat;
        categoryFilter.appendChild(option);
      });
    }

    function renderPrompts(prompts) {
      const container = document.getElementById("promptContainer");
      container.innerHTML = "";
      if (!prompts.length) {
        container.innerHTML = "<p class='text-gray-500'>No prompts found.</p>";
        return;
      }
      prompts.forEach(p => {
        const card = document.createElement("div");
        card.className = "bg-white shadow-md rounded-lg p-4";
        card.innerHTML = `
          <h2 class="text-lg font-semibold mb-2">${p.title}</h2>
          <p class="text-sm text-gray-500 mb-2">Category: ${p.category}</p>
          <pre class="bg-gray-100 p-2 rounded text-sm whitespace-pre-wrap">${p.prompt}</pre>
        `;
        container.appendChild(card);
      });
    }

    function applyFilters() {
      const searchQuery = document.getElementById("searchInput").value.toLowerCase();
      const selectedCategory = document.getElementById("categoryFilter").value;

      filteredPrompts = allPrompts.filter(p => {
        const matchesSearch =
          p.title.toLowerCase().includes(searchQuery) ||
          p.category.toLowerCase().includes(searchQuery) ||
          p.prompt.toLowerCase().includes(searchQuery);

        const matchesCategory =
          selectedCategory === "all" || p.category.toLowerCase() === selectedCategory;

        return matchesSearch && matchesCategory;
      });

      renderPrompts(filteredPrompts);
    }

    function showRandomPrompt() {
      if (!filteredPrompts.length) return;
      const randomIndex = Math.floor(Math.random() * filteredPrompts.length);
      const randomPrompt = filteredPrompts[randomIndex];
      renderPrompts([randomPrompt]);
    }

    document.getElementById("searchInput").addEventListener("input", applyFilters);
    document.getElementById("categoryFilter").addEventListener("change", applyFilters);

    window.onload = loadPrompts;
  </script>

</body>
</html>
